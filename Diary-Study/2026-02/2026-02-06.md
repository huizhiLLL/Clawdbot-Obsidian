# 学习日记 - 2026-02-06

## 主题：JS 异步编程基础

### 📚 核心知识点

#### 1. 理解同步与异步

**同步（Synchronous）**
```javascript
console.log("1");
console.log("2");
console.log("3");
// 输出: 1 → 2 → 3
```

**异步（Asynchronous）**
```javascript
console.log("1");
setTimeout(() => console.log("2"), 1000);
console.log("3");
// 输出: 1 → 3 → 2 (2会在1秒后输出)
```

**关键概念：**
- 同步代码按顺序执行，前一个任务完成后才执行下一个
- 异步代码不会阻塞后续代码的执行，在后台运行

#### 2. Promise 基础

**创建 Promise**
```javascript
const myPromise = new Promise((resolve, reject) => {
  // 模拟异步操作
  setTimeout(() => {
    const success = Math.random() > 0.5;
    if (success) {
      resolve("操作成功！");
    } else {
      reject("操作失败！");
    }
  }, 1000);
});
```

**使用 Promise（then/catch）**
```javascript
myPromise
  .then(result => {
    console.log(result); // "操作成功！"
  })
  .catch(error => {
    console.error(error); // "操作失败！"
  });
```

**Promise 三种状态：**
- **Pending**（等待中）：初始状态
- **Fulfilled**（已成功）：resolve 被调用
- **Rejected**（已失败）：reject 被调用

#### 3. async/await 语法

**async 函数**
```javascript
async function fetchData() {
  return "数据已获取";
}

// async 函数返回一个 Promise
fetchData().then(data => console.log(data));
```

**await 关键字**
```javascript
async function main() {
  console.log("开始");

  // await 会暂停函数执行，直到 Promise 解决
  const result = await new Promise(resolve => {
    setTimeout(() => resolve("完成"), 1000);
  });

  console.log(result); // 1秒后输出: "完成"
  console.log("结束");
}

main();
```

**错误处理**
```javascript
async function main() {
  try {
    const result = await myPromise;
    console.log(result);
  } catch (error) {
    console.error("出错了:", error);
  }
}
```

#### 4. 实际应用场景

**模拟 API 请求**
```javascript
// 模拟获取用户数据
function fetchUser(id) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (id === 1) {
        resolve({ id: 1, name: "会枝", age: 20 });
      } else {
        reject(new Error("用户不存在"));
      }
    }, 500);
  });
}

// 使用 async/await
async function getUserInfo() {
  try {
    const user = await fetchUser(1);
    console.log(user); // { id: 1, name: "会枝", age: 20 }
  } catch (error) {
    console.error(error.message);
  }
}

getUserInfo();
```

### 🔗 关联知识

- **事件循环**：JavaScript 异步机制的底层原理
- **回调地狱**：Promise 解决的问题
- **fetch API**：现代浏览器进行 HTTP 请求的标准方法
- **Vue 异步组件**：`defineAsyncComponent()` 使用 Promise

### 💻 练习

1. **基础练习：创建 Promise**
   ```javascript
   // 创建一个 Promise，2秒后返回一个随机数
   // 然后使用 then/catch 处理结果
   ```

2. **进阶练习：async/await**
   ```javascript
   async function waitAndPrint(message, delay) {
     // 使用 await 实现：等待 delay 毫秒后打印 message
   }

   // 测试
   await waitAndPrint("Hello", 1000); // 1秒后输出 "Hello"
   await waitAndPrint("World", 2000); // 再2秒后输出 "World"
   ```

3. **实战练习：顺序执行**
   ```javascript
   // 模拟三个异步操作，按顺序执行并收集结果
   function step1() {
     return Promise.resolve("步骤1完成");
   }

   function step2(data) {
     return Promise.resolve(`${data} → 步骤2完成`);
   }

   function step3(data) {
     return Promise.resolve(`${data} → 步骤3完成`);
   }

   // 使用 async/await 或 then 链式调用，按顺序执行
   ```

### 📖 延伸阅读

- MDN: [Promise](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise)
- MDN: [async function](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function)
- MDN: [await](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/await)
- JavaScript.info: [Promise](https://zh.javascript.info/promise-basics)

---

**💡 晚上测验时间：22:00**

记得完成上面的练习，准备回答测验问题！

---

## 📝 测验问题

### 问题 1
以下代码的输出顺序是什么？请解释原因：
```javascript
console.log("Start");

setTimeout(() => {
  console.log("Timeout");
}, 0);

Promise.resolve().then(() => {
  console.log("Promise");
});

console.log("End");
```

### 问题 2
请使用 `async/await` 改写以下代码，使 `data1` 和 `data2` 顺序获取：
```javascript
fetchData1().then(data1 => {
  fetchData2(data1).then(data2 => {
    console.log(data2);
  });
});
```

### 问题 3
`async` 函数和普通函数有什么区别？`await` 关键字只能在什么环境下使用？

---

## 🎯 学习进度记录

（等待用户回答后记录...）
